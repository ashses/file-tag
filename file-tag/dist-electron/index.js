"use strict";const t=require("electron"),s=require("path"),c=require("child_process"),l=require("url");function p(e){const r=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const n in e)if(n!=="default"){const o=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,o.get?o:{enumerable:!0,get:()=>e[n]})}}return r.default=e,Object.freeze(r)}const u=p(l),d=require("net");let i;function f(){return new Promise((e,r)=>{i=c.exec("main.exe",(o,w,h)=>{o&&r(o)});const n=()=>{const o=d.createConnection({port:25566},()=>{o.end(),e(()=>{})});o.on("error",()=>{setTimeout(n,1e3)})};n()})}const a=async()=>{t.Menu.setApplicationMenu(null);const e=new t.BrowserWindow({title:"文件标签管理器",width:1280,height:720,resizable:!1,webPreferences:{contextIsolation:!1,nodeIntegration:!0,preload:s.join(__dirname,"./preload.js")}});process.env.NODE_ENV!=="development"?await e.loadURL(u.format({pathname:s.join(__dirname,"index.html"),protocol:"file:",slashes:!0})):(e.loadURL("http://localhost:5173"),e.webContents.openDevTools())};t.app.on("window-all-closed",()=>{i&&i.kill(),process.platform!=="darwin"&&t.app.quit()});t.app.on("activate",()=>{t.BrowserWindow.getAllWindows().length===0&&a()});t.app.on("ready",async()=>{try{await f(),i.on("close",()=>{t.app.quit()}),a()}catch(e){console.error("无法启动Python服务器",e),t.app.quit()}});t.app.on("quit",()=>{});
